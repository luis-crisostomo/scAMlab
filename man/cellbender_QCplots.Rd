% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_cellbender_QC.r
\name{cellbender_QCplots}
\alias{cellbender_QCplots}
\title{Generate CellBender QC plots}
\usage{
cellbender_QCplots(
  seurat_obj,
  sample = "Sample",
  th.pct_diff_genes = 25,
  th.feature = NULL,
  th.pct_diff_cells = 25,
  th.cell = NULL,
  n_labels = 10
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing both RAW (raw counts) and RNA
(CellBender-corrected) assays. For Seurat v5, the RNA assay should have
a counts layer.}

\item{sample}{Character string. Sample name used for file naming. Default: "Sample"}

\item{th.pct_diff_genes}{Numeric. Minimum percentage difference threshold
for genes to include in Plot 2. Default: 25}

\item{th.feature}{Integer or NULL. Maximum number of genes to display in
Plot 2. If NULL, shows all genes above th.pct_diff_genes. Default: NULL}

\item{th.pct_diff_cells}{Numeric. Minimum percentage difference threshold
for cells to include in Plot 3. Default: 25}

\item{th.cell}{Integer or NULL. Maximum number of cells to display in
Plot 3. If NULL, shows all cells above th.pct_diff_cells. Default: NULL}

\item{n_labels}{Integer. Number of top genes to label in Plot 2. Default: 10}
}
\value{
A patchwork object containing six ggplot2 plots arranged in a 3x2 grid
}
\description{
Internal function that generates quality control plots comparing raw and
CellBender-corrected data for a single Seurat object. Creates six plots
showing cell probability metrics, feature/transcript comparisons, and
distribution analyses.
}
\details{
The function generates the following plots:
\itemize{
\item Plot 1: Cell probability vs background fraction
\item Plot 2: Raw vs CellBender features (genes) with top changed genes labeled
\item Plot 3: Raw vs CellBender transcripts (cells)
\item Plot 4: Cell probability vs droplet efficiency
\item Plot 5: Genes detected per cell density comparison
\item Plot 6: Cell UMI distribution density comparison
}

The function also saves two CSV files:
\itemize{
\item {sample}_Feature_stats.csv: Gene-level statistics
\item {sample}_Cell_stats.csv: Cell-level statistics
}
}
\keyword{internal}
