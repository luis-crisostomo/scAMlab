% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_cellbender_QC.r
\name{run_cellbender_QC}
\alias{run_cellbender_QC}
\title{Run CellBender QC Analysis}
\usage{
run_cellbender_QC(
  seurat_input,
  sample_names = NULL,
  param = NULL,
  th.pct_diff_genes = 25,
  th.feature = NULL,
  th.pct_diff_cells = 25,
  th.cell = NULL,
  n_labels = 10
)
}
\arguments{
\item{seurat_input}{A Seurat object or a list of Seurat objects. Each object
must contain:
\itemize{
\item RAW assay: Raw count matrix
\item RNA assay: CellBender-corrected count matrix
}
For Seurat v5 objects, the RNA assay must have a 'counts' layer.}

\item{sample_names}{Character vector. Names for each sample, used in file
naming and plot titles. If NULL, defaults to "Sample" for single objects
or "Sample_1", "Sample_2", etc. for lists. Default: NULL}

\item{param}{BiocParallelParam object for parallel processing (e.g.,
MulticoreParam, SnowParam). If NULL, runs sequentially. Default: NULL}

\item{th.pct_diff_genes}{Numeric. Minimum percentage difference threshold
for genes to include in the feature comparison plot. Default: 25}

\item{th.feature}{Integer or NULL. Maximum number of genes to display in
the feature comparison plot. If NULL, shows all genes above
th.pct_diff_genes threshold. Default: NULL}

\item{th.pct_diff_cells}{Numeric. Minimum percentage difference threshold
for cells to include in the transcript comparison plot. Default: 25}

\item{th.cell}{Integer or NULL. Maximum number of cells to display in the
transcript comparison plot. If NULL, shows all cells above
th.pct_diff_cells threshold. Default: NULL}

\item{n_labels}{Integer. Number of top genes to label in the feature
comparison plot. Default: 10}
}
\value{
\itemize{
\item For single Seurat object: Returns a patchwork plot object
\item For list of Seurat objects: Returns a named list of patchwork plot objects
}
}
\description{
Generate quality control plots comparing raw and CellBender-corrected
single-cell RNA-seq data. Supports both single Seurat objects and lists
of Seurat objects with optional parallel processing.
}
\details{
This function compares raw and CellBender-corrected data across multiple
dimensions:
\itemize{
\item Gene-level changes: Total UMI counts per gene
\item Cell-level changes: Total UMI counts per cell
\item Detection rates: Number of genes detected per cell
\item CellBender metrics: Cell probability, background fraction, droplet efficiency
}

For each sample, the function saves:
\itemize{
\item A TIFF image with 6 QC plots (18x10 inches, 200 DPI)
\item A CSV file with gene-level statistics
\item A CSV file with cell-level statistics
}
}
\section{Parallel Processing}{

When processing multiple samples, you can enable parallel processing by
providing a BiocParallelParam object. For example:
\preformatted{
library(BiocParallel)
# For Unix-like systems (Linux, macOS)
param <- MulticoreParam(workers = 4)

# For Windows
param <- SnowParam(workers = 4, type = "SOCK")
}
}

\examples{
\dontrun{
# Single Seurat object
result <- run_cellbender_QC(
  seurat_input = seurat_obj,
  sample_names = "Sample1",
  th.pct_diff_genes = 30
)

# Multiple Seurat objects with parallel processing
library(BiocParallel)
param <- MulticoreParam(workers = 4)

results <- run_cellbender_QC(
  seurat_input = list(obj1, obj2, obj3),
  sample_names = c("Control", "Treatment1", "Treatment2"),
  param = param,
  th.pct_diff_genes = 25,
  n_labels = 15
)
}

}
\seealso{
\code{\link[BiocParallel]{BiocParallelParam}} for parallel processing options
}
