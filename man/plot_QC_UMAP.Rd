% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_QC_UMAP.r
\name{plot_QC_UMAP}
\alias{plot_QC_UMAP}
\title{Generate Comprehensive QC UMAP Plots}
\usage{
plot_QC_UMAP(
  seurat.obj,
  nfeatures = 8000,
  filename = "QC_UMAP",
  genes_to_plot = c("Ptprc", "Csf1r"),
  assay = "RNA"
)
}
\arguments{
\item{seurat.obj}{A Seurat object containing single-cell RNA-seq data}

\item{nfeatures}{Either a numeric value specifying the number of variable
features to identify (default: 8000), or a character vector of specific
gene names to use as variable features}

\item{filename}{Character string. Base name for the output TIFF file
(without extension). Default: "QC_UMAP"}

\item{genes_to_plot}{Character vector of length 2. Gene names to display
in feature plots in the fourth row. Default: c("Ptprc", "Csf1r")}

\item{assay}{Character string. Name of the assay to use for analysis.
Default: "RNA"}
}
\value{
Invisibly returns NULL. The function is called for its side effect
of saving a multi-panel UMAP plot.
}
\description{
Performs standard Seurat preprocessing (normalization, scaling, PCA,
clustering, UMAP) and generates a comprehensive set of quality control
visualizations arranged in a 4-row layout. This function is designed for
rapid QC assessment of single-cell RNA-seq data.
}
\details{
The function generates a 4-row visualization layout:

\strong{Row 1 (3 panels):}
\itemize{
\item Cluster assignments with labels
\item nCount_RNA distribution (discrete quantile bins: q5, q25, q50, q75, q95)
\item nFeature_RNA distribution (discrete quantile bins: q5, q25, q50, q75, q95)
}

\strong{Row 2 (3 panels):}
\itemize{
\item Mitochondrial percentage (percent.mt)
\item Ribosomal percentage (percent.rb)
\item Background fraction (if available) or contamination score
}

\strong{Row 3 (3 panels):}
\itemize{
\item Novelty difference (log10GenesPerUMI difference from cluster median)
\item Fast cluster assignments
\item Doublet classification
}

\strong{Row 4 (3 panels):}
\itemize{
\item Most common largest genes (genes with highest expression per cell,
showing genes appearing in ≥500 cells)
\item User-specified gene 1 expression
\item User-specified gene 2 expression
}
}
\section{Processing Steps}{

The function performs the following Seurat workflow:
\enumerate{
\item Normalization (NormalizeData)
\item Variable feature selection (FindVariableFeatures or user-defined)
\item Scaling (ScaleData)
\item PCA (RunPCA)
\item Clustering (FindNeighbors + FindClusters at resolution 0.5)
\item UMAP dimensionality reduction (RunUMAP, dims 1:20)
}
}

\section{Required Metadata}{

The function expects the following metadata columns in the Seurat object:
\itemize{
\item nCount_RNA, nFeature_RNA (automatically computed by Seurat)
\item percent.mt, percent.rb (mitochondrial and ribosomal percentages)
\item novelty_diff (difference from cluster median novelty score)
\item fastcluster_clusters (preliminary cluster assignments)
\item doublet_class (doublet detection results)
\item largest_gene (gene with highest counts per cell)
\item background_fraction (optional, from CellBender)
\item contamination_score (optional, used if background_fraction is missing)
}
}

\section{Output}{

Saves a TIFF file with dimensions 15×20 inches at 200 DPI resolution.
The file is saved using the SaveFigure function with the specified filename.
}

\examples{
\dontrun{
# Basic usage with default parameters
plot_QC_UMAP(seurat_obj)

# Custom number of variable features and output name
plot_QC_UMAP(
  seurat.obj = seurat_obj,
  nfeatures = 5000,
  filename = "Sample1_QC",
  genes_to_plot = c("Cd3e", "Ms4a1")
)

# Using specific genes as variable features
custom_genes <- c("Gene1", "Gene2", "Gene3", ...)
plot_QC_UMAP(
  seurat.obj = seurat_obj,
  nfeatures = custom_genes,
  filename = "Custom_features_QC"
)
}

}
\seealso{
\code{\link{run_cellbender_QC}} for CellBender-specific QC plots
\code{\link{plot_QC_classic}} for classical, Seurat-suggested QC plots
\code{\link{plot_QC_babraham}} for Babraham Institute QC plots (https://www.bioinformatics.babraham.ac.uk/training/10XRNASeq/seurat_workflow.html#QC)
}
