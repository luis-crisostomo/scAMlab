% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/score_CellCycle.r
\name{score_CellCycle}
\alias{score_CellCycle}
\title{Score Cell Cycle Phase for Single-Cell RNA-seq Data}
\usage{
score_CellCycle(seurat.obj, assay = "RNA", species = "mouse")
}
\arguments{
\item{seurat.obj}{A Seurat object}

\item{assay}{Character string. Name of the assay to use for scoring.
Default: "RNA"}

\item{species}{Character string. Species of the data: "human" or "mouse".
For mouse, human cell cycle genes are converted to mouse orthologs.
Default: "mouse"}
}
\value{
Returns the Seurat object with added metadata columns:
\itemize{
\item \strong{S.Score}: S phase score
\item \strong{G2M.Score}: G2M phase score
\item \strong{Phase}: Predicted cell cycle phase (G1, S, or G2M)
\item \strong{CC.Difference}: Difference between S and G2M scores (S.Score - G2M.Score)
}
}
\description{
Assigns cell cycle phase scores (S and G2M) to cells based on expression of
canonical cell cycle markers. For mouse data, automatically converts human
cell cycle genes to mouse orthologs using gprofiler2.
}
\details{
The function uses the updated 2019 cell cycle gene list from Seurat
(\code{cc.genes.updated.2019}). For mouse data, orthologous genes are
identified using gprofiler2's \code{gorth} function.

Cell cycle phases are assigned based on relative scores:
\itemize{
\item \strong{S phase}: High S.Score
\item \strong{G2M phase}: High G2M.Score
\item \strong{G1 phase}: Low scores for both S and G2M
}

The \strong{CC.Difference} score is useful for:
\itemize{
\item Regressing out cell cycle effects (negative values indicate G2M, positive indicate S)
\item Identifying actively cycling vs. quiescent cells
\item Visualizing cell cycle progression as a continuous variable
}

If fewer than 5 genes are found for either S or G2M phase, the function
returns the object unchanged with a warning.
}
\section{Gene Availability}{

The function reports how many cell cycle genes were found in the dataset.
Low gene recovery may indicate:
\itemize{
\item Different gene naming conventions (e.g., Ensembl IDs instead of symbols)
\item Aggressive gene filtering removed cell cycle markers
\item Species mismatch
}
}

\examples{
\dontrun{
# Mouse data (default)
seurat_obj <- score_CellCycle(seurat_obj, species = "mouse")

# Human data
seurat_obj <- score_CellCycle(seurat_obj, species = "human")

# Visualize cell cycle phase
DimPlot(seurat_obj, group.by = "Phase")
FeaturePlot(seurat_obj, features = c("S.Score", "G2M.Score"))

# Visualize as continuous variable
FeaturePlot(seurat_obj, features = "CC.Difference")

# Regress out cell cycle effects during scaling
seurat_obj <- ScaleData(
  seurat_obj,
  vars.to.regress = c("S.Score", "G2M.Score")
)

# Or regress out the difference score
seurat_obj <- ScaleData(
  seurat_obj,
  vars.to.regress = "CC.Difference"
)

# Check distribution of cell cycle phases
table(seurat_obj$Phase)
}

}
\references{
Kolberg, L., Raudvere, U., Kuzmin, I. and  Vilo, J. (2020). gprofiler2 -- an R package for gene list functional enrichment analysis and namespace conversion toolset g:Profiler. F1000Research, 9(ELIXIR):709. DOI: https://doi.org/10.12688/f1000research.24956.2
}
\seealso{
\code{\link[Seurat]{CellCycleScoring}} for the underlying scoring function
}
