% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_empty_cells.r
\name{filter_empty_cells}
\alias{filter_empty_cells}
\title{Filter empty droplets from Seurat objects using emptyDrops}
\usage{
filter_empty_cells(
  seurat_obj,
  threshold = 100,
  test.ambient = TRUE,
  FDR = 0.001,
  save_plots = TRUE,
  plot_dir = "empty_cells_plots/",
  plot_prefix = NULL,
  verbose = TRUE,
  BPPARAM = NULL,
  ...
)
}
\arguments{
\item{seurat_obj}{Seurat object to filter}

\item{threshold}{Minimum UMI count threshold for emptyDrops testing (default: 100)}

\item{test.ambient}{Logical, whether to test ambient contamination (default: TRUE)}

\item{FDR}{False discovery rate threshold for keeping cells (default: 0.001)}

\item{save_plots}{Logical, whether to save diagnostic plots (default: TRUE)}

\item{plot_dir}{Directory to save plots (default: "empty_cells_plots/")}

\item{plot_prefix}{Optional prefix for plot filenames}

\item{verbose}{Logical, whether to print progress messages (default: TRUE)}

\item{...}{Additional arguments passed to emptyDrops()}

\item{return_background}{Logical, whether to return background matrix for decontamination (default: TRUE)}
}
\value{
Filtered Seurat object with:
\itemize{
\item RNA assay: Filtered count matrix (cells passing emptyDrops)
\item RAW assay: Original unfiltered count matrix (for background estimation)
\item Added metadata: cell_probability, barcode_rank, etc.
\item Plots saved to specified directory
}
}
\description{
This function applies emptyDrops filtering to remove empty droplets from
single-cell RNA-seq data. It preserves background information for downstream
decontamination and adds relevant metadata to the Seurat object.
}
